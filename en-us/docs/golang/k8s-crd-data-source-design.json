{
  "filename": "k8s-crd-data-source-design.md",
  "__html": "<h1>RFC: Kubernetes CRD data-source</h1>\n<h2>Motivation</h2>\n<ul>\n<li>utilizing K8S CRD API to extend dynamic datasource. Standardizing the CRD, listing on custom resource and updating the newest state by controller.</li>\n<li>Extending the sentinel rules for components circuit breaker、flow control、 hotspot arguments control、system adaptive control</li>\n</ul>\n<h2>High Level Architecture</h2>\n<pre><code>                                                                                                                   +--------------------------------+\n                                                                                                                   |                                |\n                                                   |                                                               |                                |\n                                                   |                                                               |                                |\n                                                   |                                                               |                                |\n                                                   |  Apply Sentinel                                               |   Sentinel K8s Datasource -&gt;   |\n                                                   |    Rule CRDs                                                  |          RuleManager           |\n                                                   |                                       +-----------------------&gt;                                |\n                                                   |                                       |                       |                                |\n                                                   |                                       |                       |                                |\n                                                   |                                       |                       |                                |\n                               +-------------------v----------------+                      |                       |                                |\n      Kubectl                  |                                    |                      |                       +--------------------------------+\n                               |                                    |                      |                       |                                |\n-------------------------------&gt;                                    |                      |                       |                                |\n                               |                                    |                      |                       |                                |\n                     Apply     |                                    |      Listen and      |                       |                                |\n                  Sentinel CR  |          K8S API Server/           |      Controller      |                       |   Sentinel K8s Datasource -&gt;   |\n                               |             CRD Server             +----------------------+-----------------------&gt;          RuleManager           |\n                               |                                    |                      |                       |                                |\n Sentinel Dashboard            |                                    |                      |                       |                                |\n     K8s-client                |                                    |                      |                       |                                |\n-------------------------------&gt;                                    |                      |                       |                                |\n                               |                                    |                      |                       |                                |\n                               |                                    |                      |                       +--------------------------------+\n                               +------------------------------------+                      |                       |                                |\n                                                                                           |                       |                                |\n                                                                                           |                       |                                |\n                                                                                           |                       |                                |\n                                                                                           |                       |   Sentinel K8s Datasource -&gt;   |\n                                                                                           +-----------------------&gt;          RuleManager           |\n                                                                                                                   |                                |\n                                                                                                                   |                                |\n                                                                                                                   |                                |\n                                                                                                                   |                                |\n                                                                                                                   |                                |\n                                                                                                                   +--------------------------------+\n</code></pre>\n<h2>CRD Schema</h2>\n<p>The Schema refer to PR: <a href=\"https://github.com/alibaba/sentinel-golang/pull/182/files\">K8S CRD definition for Sentinel rules</a></p>\n<h2>CRD Controller</h2>\n<p>CRDs Controller are based on <a href=\"https://sdk.operatorframework.io/docs/golang/quickstart/\">operator framework SDK</a>. The handler logic of datasource is same with other datasource(etcd、consul...)</p>\n"
}