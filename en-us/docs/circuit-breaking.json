{
  "filename": "circuit-breaking.md",
  "__html": "<h1>Circuit Breaking</h1>\n<h2>Introduction</h2>\n<p>Circuit breaking provides stability and prevents cascading failures in distributed systems.</p>\n<p><img src=\"https://user-images.githubusercontent.com/9434884/62410811-cd871680-b61d-11e9-9df7-3ee41c618644.png\" alt=\"chain\"></p>\n<blockquote>\n<p>Note: This document is for Sentinel 1.8.0 or above.</p>\n</blockquote>\n<h2>Circuit breaker strategy</h2>\n<ul>\n<li><strong>Slow Request Ratio</strong>: Circuit breaking by slow request ratio. We'll need to provide the &quot;upper-bound response time&quot;, and requests whose RT exceeds the upper-bound RT will be recorded as a slow request.</li>\n<li><strong>Error Ratio</strong>: Circuit breaking by the error ratio (error count / total completed count).</li>\n<li><strong>Error Count</strong>: Circuit breaking by the number of exceptions.</li>\n</ul>\n<h2>Circuit breaker rules</h2>\n<p>For circuit breaking rules, you can refer to <a href=\"https://github.com/alibaba/Sentinel/wiki/How-to-Use#circuit-breaking-rules-degraderule\">here</a>.</p>\n<h2>Circuit breaker state change observer</h2>\n<pre><code class=\"language-java\">EventObserverRegistry.getInstance().addStateChangeObserver(<span class=\"hljs-string\">\"logging\"</span>,\n    (prevState, newState, rule, snapshotValue) -&gt; {\n        <span class=\"hljs-keyword\">if</span> (newState == State.OPEN) {\n            System.err.println(String.format(<span class=\"hljs-string\">\"%s -&gt; OPEN at %d, snapshotValue=%.2f\"</span>, prevState.name(),\n                TimeUtil.currentTimeMillis(), snapshotValue));\n        } <span class=\"hljs-keyword\">else</span> {\n            System.err.println(String.format(<span class=\"hljs-string\">\"%s -&gt; %s at %d\"</span>, prevState.name(), newState.name(),\n                TimeUtil.currentTimeMillis()));\n        }\n    });\n</code></pre>\n<h2>Demo</h2>\n<p><a href=\"https://github.com/alibaba/Sentinel/blob/master/sentinel-demo/sentinel-demo-basic/src/main/java/com/alibaba/csp/sentinel/demo/degrade/SlowRatioCircuitBreakerDemo.java\">SlowRatioCircuitBreakerDemo</a></p>\n"
}